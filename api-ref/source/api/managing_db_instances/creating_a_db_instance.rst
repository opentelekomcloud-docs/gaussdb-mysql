:original_name: gaussdb_04_0004.html

.. _gaussdb_04_0004:

Creating a DB instance
======================

Function
--------

This API is used to create a GaussDB(for MySQL) DB instance

-  Learn how to :ref:`authorize and authenticate <gaussdb_03_0001>` this API before using it.
-  Before calling this API, obtain the required :ref:`region and endpoint <gaussdb_00_0003>`.

URI
---

-  URI format

   POST https://{*Endpoint*}/mysql/v3/{project_id}/instances

-  Example

   POST https://{*Endpoint*}/mysql/v3/0483b6b16e954cb88930a360d2c4e663/instances

-  Parameter description

   .. table:: **Table 1** Parameter description

      +-----------------------+-----------------------+----------------------------------------------------------------------------+
      | Name                  | Mandatory             | Description                                                                |
      +=======================+=======================+============================================================================+
      | project_id            | Yes                   | Project ID of a tenant in a region.                                        |
      |                       |                       |                                                                            |
      |                       |                       | To obtain this value, see :ref:`Obtaining a Project ID <gaussdb_10_0004>`. |
      +-----------------------+-----------------------+----------------------------------------------------------------------------+

Request
-------

.. table:: **Table 2** Parameter description

   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Name                     | Mandatory                                                                               | Type            | Description                                                                                                                                                                                                                               |
   +==========================+=========================================================================================+=================+===========================================================================================================================================================================================================================================+
   | charge_info              | No                                                                                      | Object          | Billing mode.                                                                                                                                                                                                                             |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | For details, see :ref:`Table 3 <gaussdb_04_0004__table1935491614524>`.                                                                                                                                                                    |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name                     | Yes                                                                                     | String          | DB instance name.                                                                                                                                                                                                                         |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | DB instances of the same type can have same names under the same tenant.                                                                                                                                                                  |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | The value must be 4 to 64 characters in length and start with a letter. It is case-sensitive and can contain only letters, digits, hyphens (-), and underscores (_).                                                                      |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | datastore                | Yes                                                                                     | Object          | Database information.                                                                                                                                                                                                                     |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | For details, see :ref:`Table 4 <gaussdb_04_0004__table64243102>`.                                                                                                                                                                         |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | mode                     | Yes                                                                                     | String          | DB instance type. Currently, only the cluster type is supported.                                                                                                                                                                          |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | flavor_ref               | Yes                                                                                     | String          | Specification code.                                                                                                                                                                                                                       |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | vpc_id                   | Yes                                                                                     | String          | VPC ID. To obtain this value, use either of the following methods:                                                                                                                                                                        |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | -  Method 1: Log in to the VPC console and view the VPC ID on the VPC details page.                                                                                                                                                       |
   |                          |                                                                                         |                 | -  Method 2: See "Querying VPCs" in the *Virtual Private Cloud API Reference*.                                                                                                                                                            |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | subnet_id                | Yes                                                                                     | String          | Network ID. To obtain this value, use either of the following methods:                                                                                                                                                                    |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | -  Method 1: Log in to the VPC console and click the target subnet on the **Subnets** page. You can view the network ID on the displayed page.                                                                                            |
   |                          |                                                                                         |                 | -  Method 2: See "Querying Subnets" in the *Virtual Private Cloud API Reference*.                                                                                                                                                         |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | security_group_id        | No                                                                                      | String          | Security group ID.                                                                                                                                                                                                                        |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | If the network ACL is enabled for the subnet used by the created DB instance, this parameter is optional. If the network ACL is not enabled, this parameter is mandatory.                                                                 |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | -  Method 1: Log in to VPC console. Choose **Access Control** > **Security Groups** in the navigation pane on the left. On the displayed page, click the target security group. You can view the security group ID on the displayed page. |
   |                          |                                                                                         |                 | -  Method 2: See "Querying Security Groups" in the *Virtual Private Cloud API Reference*.                                                                                                                                                 |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | configuration_id         | No                                                                                      | String          | Parameter template ID.                                                                                                                                                                                                                    |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | password                 | Yes                                                                                     | String          | Database password.                                                                                                                                                                                                                        |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | Valid value:                                                                                                                                                                                                                              |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | The password is 8 to 32 characters long and must contain at least three types of the following: uppercase letters, lowercase letters, digits, and special characters (``~!@#%^*-_=+?``).                                                  |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | You are advised to enter a strong password to improve security and prevent security risks such as brute force cracking. If you enter a weak password, the system automatically determines that the password is invalid.                   |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | backup_strategy          | No                                                                                      | Object          | Automated backup policy.                                                                                                                                                                                                                  |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | For details, see :ref:`Table 5 <gaussdb_04_0004__table0863181193416>`.                                                                                                                                                                    |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | time_zone                | No                                                                                      | String          | UTC time zone.                                                                                                                                                                                                                            |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | -  If this parameter is not specified, UTC is used by default.                                                                                                                                                                            |
   |                          |                                                                                         |                 | -  If this parameter is specified, the value ranges from UTC-12:00 to UTC+12:00 at the full hour. For example, the parameter can be **UTC+08:00** rather than **UTC+08:30**.                                                              |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | availability_zone_mode   | Yes                                                                                     | String          | AZ type. The value can be **single** or **multi**.                                                                                                                                                                                        |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | master_availability_zone | If **availability_zone_mode** is set to **multi**, this parameter is mandatory.         | String          | Primary AZ.                                                                                                                                                                                                                               |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          | If **availability_zone_mode** is set to **single**, this parameter cannot be specified. |                 |                                                                                                                                                                                                                                           |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | slave_count              | Yes                                                                                     | Integer         | Number of read-only nodes from 1 to 9. A DB instance can have a maximum of 15 read-only nodes.                                                                                                                                            |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | region                   | Yes                                                                                     | String          | Region ID.                                                                                                                                                                                                                                |
   |                          |                                                                                         |                 |                                                                                                                                                                                                                                           |
   |                          |                                                                                         |                 | The value cannot be empty. To obtain this value, see `Regions and Endpoints <https://docs.otc.t-systems.com/en-us/endpoint/index.html>`__.                                                                                                |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_project_id    | No                                                                                      | String          | Enterprise project ID. This parameter is mandatory only when the enterprise project is enabled.                                                                                                                                           |
   +--------------------------+-----------------------------------------------------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _gaussdb_04_0004__table1935491614524:

.. table:: **Table 3** charge_info field data structure description

   +-----------------+-----------------+-----------------+---------------------+
   | Name            | Mandatory       | Type            | Description         |
   +=================+=================+=================+=====================+
   | charge_mode     | Yes             | String          | Billing mode.       |
   |                 |                 |                 |                     |
   |                 |                 |                 | Value: **postPaid** |
   +-----------------+-----------------+-----------------+---------------------+

.. _gaussdb_04_0004__table64243102:

.. table:: **Table 4** datastore field data structure description

   +-----------------+-----------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------+
   | Name            | Mandatory       | Type            | Description                                                                                                                   |
   +=================+=================+=================+===============================================================================================================================+
   | type            | Yes             | String          | DB engine. Currently, only gaussdb-mysql is supported.                                                                        |
   +-----------------+-----------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------+
   | version         | Yes             | String          | DB version.                                                                                                                   |
   |                 |                 |                 |                                                                                                                               |
   |                 |                 |                 | For details about supported DB versions, see section :ref:`Querying Version Information About a DB Engine <gaussdb_04_0001>`. |
   +-----------------+-----------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------+

.. _gaussdb_04_0004__table0863181193416:

.. table:: **Table 5** backup_strategy field data structure description

   +------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------------+
   | Name       | Mandatory | Type   | Description                                                                                                                     |
   +============+===========+========+=================================================================================================================================+
   | start_time | Yes       | String | Automated backup start time. The automatic backup will be triggered within one hour after the time specified by this parameter. |
   +------------+-----------+--------+---------------------------------------------------------------------------------------------------------------------------------+

.. note::

   The value of **region** in the following is used as an example.

-  Request example

   .. code-block:: text

      {
      "charge_info":{
              "charge_mode":"postPaid"
          },
          "region":"cn-north-4b",
          "name":"gaussdb-2d34",
          "datastore":{
              "type":"gaussdb-mysql",
              "version":"8.0"
          },
          "mode":"Cluster",
          "flavor_ref":"gaussdb.mysql.large.4",
          "vpc_id":"f7ee62e2-9705-4523-ba49-a85ea1a1fa87",
          "subnet_id":"140af7bf-a9da-4dcf-8837-34199fd6d186",
          "security_group_id":"c7f69884-fe2b-4630-8114-70a11499d902",
          "configuration_id":"43570e0de32e40c5a15f831aa5ce4176pr07",
          "password":"Gauss_234",
          "backup_strategy":{
              "start_time":"17:00-18:00"
          },
          "time_zone":"UTC+08:00",
          "availability_zone_mode":"single",
          "master_availability_zone":"az1pod1",
          "slave_count":1,
          "enterprise_project_id":"0"
      }

Response
--------

-  Normal response

   .. table:: **Table 6** Parameter description

      +-----------------------+-----------------------+-----------------------------------------------------------------------+
      | Name                  | Type                  | Description                                                           |
      +=======================+=======================+=======================================================================+
      | instance              | Object                | DB instance information.                                              |
      |                       |                       |                                                                       |
      |                       |                       | For details, see :ref:`Table 7 <gaussdb_04_0004__table175305610274>`. |
      +-----------------------+-----------------------+-----------------------------------------------------------------------+
      | job_id                | String                | DB instance creation task ID.                                         |
      +-----------------------+-----------------------+-----------------------------------------------------------------------+

   .. _gaussdb_04_0004__table175305610274:

   .. table:: **Table 7** instance field data structure description

      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Name                       | Type                  | Description                                                                                                                                                            |
      +============================+=======================+========================================================================================================================================================================+
      | id                         | String                | DB instance ID.                                                                                                                                                        |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | name                       | String                | DB instance name. DB instances of the same type can have same names under the same tenant.                                                                             |
      |                            |                       |                                                                                                                                                                        |
      |                            |                       | The value must be 4 to 64 characters in length and start with a letter. It is case-insensitive and can contain only letters, digits, hyphens (-), and underscores (_). |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | status                     | String                | DB instance status.                                                                                                                                                    |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | datastore                  | Object                | Database information.                                                                                                                                                  |
      |                            |                       |                                                                                                                                                                        |
      |                            |                       | For details, see :ref:`Table 8 <gaussdb_04_0004__table766045720277>`.                                                                                                  |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | mode                       | String                | DB instance type. Currently, only the cluster type is supported.                                                                                                       |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | configuration_id           | String                | Parameter template ID.                                                                                                                                                 |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | port                       | String                | Database port, which is the same as the request parameter.                                                                                                             |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | backup_strategy            | Object                | Automated backup policy.                                                                                                                                               |
      |                            |                       |                                                                                                                                                                        |
      |                            |                       | For details, see :ref:`Table 9 <gaussdb_04_0004__table81249589270>`.                                                                                                   |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | region                     | String                | Region ID.                                                                                                                                                             |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | availability_zone_mode     | String                | AZ ID.                                                                                                                                                                 |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | master\_ availability_zone | String                | Primary AZ ID.                                                                                                                                                         |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | vpc_id                     | String                | VPC ID.                                                                                                                                                                |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | security_group_id          | String                | Security group ID.                                                                                                                                                     |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | subnet_id                  | String                | Subnet ID.                                                                                                                                                             |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | slave_count                | Integer               | Number of read-only nodes.                                                                                                                                             |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | charge_info                | Object                | Billing mode.                                                                                                                                                          |
      |                            |                       |                                                                                                                                                                        |
      |                            |                       | For details, see :ref:`Table 10 <gaussdb_04_0004__table207147873611>`.                                                                                                 |
      +----------------------------+-----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. _gaussdb_04_0004__table766045720277:

   .. table:: **Table 8** datastore field data structure description

      ======= ====== =============
      Name    Type   Description
      ======= ====== =============
      type    String **DB Engine**
      version String DB version.
      ======= ====== =============

   .. _gaussdb_04_0004__table81249589270:

   .. table:: **Table 9** backup_strategy field data structure description

      +------------+---------+----------------------------------------------------------------------------------------+
      | Name       | Type    | Description                                                                            |
      +============+=========+========================================================================================+
      | start_time | String  | Backup time window. Automated backups will be triggered during the backup time window. |
      +------------+---------+----------------------------------------------------------------------------------------+
      | keep_days  | Integer | Backup retention days.                                                                 |
      +------------+---------+----------------------------------------------------------------------------------------+

   .. _gaussdb_04_0004__table207147873611:

   .. table:: **Table 10** charge_info field data structure description

      =========== ====== =============
      Name        Type   Description
      =========== ====== =============
      charge_mode String Billing mode.
      =========== ====== =============

.. note::

   The values of **region** and **master_availability_zone** are used as examples.

-  Example normal response

   .. code-block:: text

      {
          "instance":{
              "id":"5eebbb4c0f9f4a99b42ed1b6334569aain07",
              "name":"gaussdb-2d34",
              "status":"BUILD",
              "datastore":{
                  "type":"gaussdb-mysql",
                  "version":"8.0"
              },
              "mode":"Cluster",
              "configuration_id": "",
              "port":null,
              "backup_strategy":{
                  "start_time":null,
                  "keep_days":"7"
              },
              "enterprise_project_id": "0",
              "region":"aaa",
              "availability_zone_mode":"single",
              "master_availability_zone":"aaa",
              "vpc_id":"f7ee62e2-9705-4523-ba49-a85ea1a1fa87",
              "security_group_id":"c7f69884-fe2b-4630-8114-70a11499d902",
              "subnet_id":"140af7bf-a9da-4dcf-8837-34199fd6d186",
              "slave_count":1,
              "charge_info":{
                  "charge_mode":"postPaid"
              }
          },
          "job_id":"43672fe5-56bd-47f1-8fd1-595cded08a7c"
          }

Status Code
-----------

For details, see :ref:`Status Codes <gaussdb_10_0002>`.

Error Code
----------

For details, see :ref:`Error Codes <gaussdb_10_0003>`.
